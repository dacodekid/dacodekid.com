import{g as p,aj as $,x as K,ak as S,E as O,al as A,am as L,an as E,ao as k,y as P,R as U,l as F,ap as _,j as B,O as H,aq as N,ar as W,B as q,h as x,d as z,u as V,o as m,c as v,F as j,k as f,t as M}from"./framework.af1155d1.js";import D from"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";function G(){let e=null;const t=L({pending:!1,fulfilled:null,rejected:null});function n(s){e=s,t.pending=!0,t.fulfilled=null,t.rejected=null,s.then(r=>{s===e&&(t.pending=!1,t.fulfilled=k({value:r}))}).catch(r=>{s===e&&(t.pending=!1,t.rejected=k({reason:r}))})}function o(){e=null,t.pending=!1,t.fulfilled=t.rejected=null}return{state:t,set:n,clear:o}}function J(e,t){const{state:n,set:o,clear:s}=G(),r=()=>o(e());return t!=null&&t.immediate&&r(),{state:n,run:r,clear:s}}function Q(){const e=E()||S();let t=null;const n=O(null);function o(r){s(),e.run(()=>{t=S(),t.run(()=>{n.value={expose:r()}})})}function s(){t&&(t.stop(),t=n.value=null)}return{setup:o,dispose:s,scope:A(n)}}function X(e){const t=typeof e;return e===!0||t==="string"||t==="number"||t==="symbol"}function Y(e){return X(e)?e:e.key}function Z(e){return typeof e=="object"?e:{key:e}}function ee(e){return e==null||e===!1?null:{some:e}}function te(e,t){const n=Q(),o=p(()=>{const s=$(e)?e.value:e();return ee(s)});return K(()=>{const s=o.value;return s?Y(s.some):null},s=>{s?n.setup(()=>{if(s===!0)return{expose:t(!0)};const r=o.value.some;return{expose:t(r),...Z(r)}}):n.dispose()},{immediate:!0}),p(()=>{var s;return((s=n.scope.value)==null?void 0:s.expose)??null})}function ne(e,t){var n;const o=O();return P(()=>{o.value=e()},{...t,flush:(n=t==null?void 0:t.flush)!=null?n:"sync"}),U(o)}function se(e){return E()?(N(e),!0):!1}function C(e){return typeof e=="function"?e():F(e)}const oe=typeof window<"u"&&typeof document<"u",re=e=>e!=null,h=()=>{};function ue(e,t=!0){_()?B(e):t?e():H(e)}function g(e){var t;const n=C(e);return(t=n==null?void 0:n.$el)!=null?t:n}const le=oe?window:void 0;function ae(e,t=null){const n=_();let o=()=>{};const s=W((r,i)=>(o=i,{get(){var l,u;return r(),(u=(l=n==null?void 0:n.proxy)==null?void 0:l.$refs[e])!=null?u:t},set(){}}));return ue(o),q(o),s}function ce(){const e=x(!1);return _()&&B(()=>{e.value=!0}),e}function ie(e){const t=ce();return p(()=>(t.value,!!e()))}function de(e,t,n={}){const{root:o,rootMargin:s="0px",threshold:r=.1,window:i=le,immediate:l=!0}=n,u=ie(()=>i&&"IntersectionObserver"in i),y=p(()=>{const d=C(e);return(Array.isArray(d)?d:[d]).map(g).filter(re)});let a=h;const c=x(l),I=u.value?K(()=>[y.value,g(o),c.value],([d,T])=>{if(a(),!c.value||!d.length)return;const b=new IntersectionObserver(t,{root:g(T),rootMargin:s,threshold:r});d.forEach(R=>R&&b.observe(R)),a=()=>{b.disconnect(),a=h}},{immediate:l,flush:"post"}):h,w=()=>{a(),I(),c.value=!1};return se(w),{isSupported:u,isActive:c,pause(){a(),c.value=!1},resume(){c.value=!0},stop:w}}async function fe(e,t,n){D.initialize({startOnLoad:!0,theme:n.theme});const{svg:o}=await D.render(e,t);return{svg:o}}const pe={ref:"root"},me=["innerHTML"],ve={class:"custom-block danger"},ye=f("p",{class:"custom-block-title"},"Unable to render the diagram",-1),he={class:"language-mermaid"},ge={key:1,class:"flex justify-center p-8"},we=z({__name:"MermaidRender",props:{id:{},text:{}},setup(e){const t=e,n=p(()=>decodeURIComponent(t.text)),o=x(!1);de(ae("root"),([{isIntersecting:u}])=>{o.value||(o.value=u)});const{isDark:s}=V(),r=ne(()=>s.value?"dark":"light"),i=te(()=>o.value&&{key:`${t.id}-${t.text}-${r.value}`,payload:{id:t.id,text:n.value,theme:r.value}},({payload:{id:u,text:y,theme:a}})=>J(()=>fe(u,y,{theme:a}),{immediate:!0})),l=p(()=>{var u;return(u=i.value)==null?void 0:u.expose.state});return(u,y)=>{var a,c;return m(),v("div",pe,[l.value&&!l.value.pending?(m(),v(j,{key:0},[l.value.fulfilled?(m(),v("pre",{key:0,"data-mermaid":"",class:"flex justify-center",innerHTML:l.value.fulfilled.value.svg},null,8,me)):(m(),v(j,{key:1},[f("div",ve,[ye,f("p",null,M((c=(a=l.value)==null?void 0:a.rejected)==null?void 0:c.reason),1)]),f("div",he,[f("pre",null,[f("code",null,M(n.value),1)])])],64))],64)):(m(),v("div",ge,"Rendering the diagram..."))],512)}}});export{we as default};
